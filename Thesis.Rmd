---
title: "PeruOECD"
author: "Luisa Olaya"
date: "1/19/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(42) #for consistent results
library(haven)
library(foreign)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stargazer)
library(naniar)

Peru <- read.dta("/Users/lu/Dropbox/Hertie/3/Thesis/R/Peru.dta")

```

## R Markdown

###Subsetting the data 

```{r cars}

newPeru <- Peru %>% 
  select("age_r", "gender_r","b_q01a", "b_q01a_t", "b_q02a", "b_q02c", "b_q10c", "b_q01b", "c_q01a", "c_q01c", "c_q02a", "d_q03", "d_q14", "d_q16a", "d_q18a_t", "f_q05a", "f_q05b", "f_q07b", "g_q04", "g_q05a", "g_q05c", "g_q05d", "g_q05e", "g_q05g", "g_q05h", "g_q06", "g_q07", "g_q08", "h_q04a", "h_q04b", "h_q05a", "h_q05c", "h_q05d", "h_q05e", "h_q05f", "h_q05g", "h_q05h", "j_q03a", "j_q03b", "j_q06b", "j_q07b","computerexperience", "monthlyincpr","yearlyincpr","salariotot", "f_q01b","f_q02b","f_q02c","f_q02d","f_q02e","f_q03b","f_q04a","f_q04b","f_q05a","f_q05b","g_q01a","g_q02a","g_q02b","g_q02c","g_q02d","g_q03b","g_q03c","g_q03d","g_q03f","g_q03g","g_q03h", "h_q01a", "h_q01b", "h_q01b_t", "h_q01c", "h_q01c_t", "h_q01d", "h_q01e", "h_q01e_t", "h_q01f", "h_q01g", "h_q01h", "h_q02a", "h_q02b","h_q02c", "h_q02d", "h_q03b", "h_q03c", "h_q03d", "h_q03f", "h_q03g", "h_q03h", "reg_tl2")

## Missing variables
##Vsualizarion of missing variables

gg_miss_var(newPeru)

#Variables with more than 60% of mnissing observations were excluded, this means those whose NAs surpassed 4.373 
##b_q02c
##b_q10c
##c_q01c
##c_q02a
##d_q16a
##g_q05a
##g_q05c
##g_q05d
##g_q05e
##g_q05g
##g_q05h
##g_q06
##g_q07
##g_q08

table(is.na(newPeru$yearlyincpr))
table(is.na(newPeru$monthlyincpr))
table(is.na(newPeru$salariotot))

newPeru1 <- drop_na(newPeru, yearlyincpr) # Do not worry if you don't understand this step, it is just to illustrate a point. only delete NA in a specific column in this case Variable 1



barplot(table(newPeru1$gender_r))

newPeru1 %>% count(gender_r)


```

##  Merging variables 

You can also embed plots, for example:

```{r pressure, echo=FALSE}

incomePlotGender <- ggplot(newPeru1, 
                         aes(x = newPeru1$yearlyincpr, y = newPeru1$computerexperience, 
                             color = gender_r)) +
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) +
  xlab("Incomne") + 
  ylab("Exoe") 

incomePlotGender

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
